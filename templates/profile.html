{% extends 'base.html' %} {% block content %}
<div class="container mt-4">
	<h1 class="text-center">{{ g.user.username }}'s Profile</h1>
	<div class="row justify-content-center">
		<div class="col-md-4 mt-3">
			{% if g.user.is_admin %}
			<div class="alert alert-dark mb-3" role="alert">
				<i class="fas fa-shield-alt"></i> <strong>Admin Account</strong>
				<a href="{{ url_for('admin_dashboard') }}" class="btn btn-dark btn-sm float-end">
					<i class="fas fa-cog"></i> Admin Panel
				</a>
			</div>
			{% endif %}

			<div class="profile-actions">
				<a href="{{url_for('update_username')}}" class="button-56">
					<i class="fas fa-user mr-2"></i>Change Username
				</a>
				<a href="{{url_for('update_email')}}" class="button-56">
					<i class="fas fa-envelope mr-2"></i>Change Email
				</a>
				<a href="{{url_for('update_password')}}" class="button-56">
					<i class="fas fa-lock mr-2"></i>Change Password
				</a>
				<a href="#delete-modal" class="button-56-red">
					<i class="fas fa-trash mr-2"></i>Delete Account
				</a>
			</div>
				<div class="card mt-4">
					<div class="card-header">
						<i class="fas fa-microphone mr-2"></i>Alexa Settings
					</div>
					<div class="card-body">
                        <div class="alert alert-warning" role="alert">
                            <strong>Under Construction:</strong> Alexa connection is not working yet.
                        </div>
						<form method="POST" action="{{ url_for('user_view') }}">
							{{ alexa_form.hidden_tag() }}
							<div class="mb-3">
								{{ alexa_form.alexa_access_token.label(class="form-label") }}
								{{ alexa_form.alexa_access_token(class="form-control", placeholder="Paste your Alexa access token or leave blank") }}
								<small class="form-text text-muted">Used to link your Alexa skill to this Auto-Cart account.</small>
							</div>
							<div class="mb-3">
								{{ alexa_form.default_grocery_list_id.label(class="form-label") }}
								{{ alexa_form.default_grocery_list_id(class="form-select") }}
								<small class="form-text text-muted">Alexa will add items to this list by default. If you choose "No default", the most recent planning list will be used.</small>
							</div>
							<button type="submit" class="btn btn-primary">Save Alexa Settings</button>
						</form>
					</div>
				</div>
			<div class="card mt-4">
				<div class="card-header">
					<i class="fas fa-book-open mr-2"></i>Household Recipe Box
					{% if g.household %}
					<small class="text-muted">({{ g.household.name }})</small>
					{% endif %}
				</div>
				<div class="card-body scrollable-list">
					<ul class="list-group list-group-flush">
						{% if g.household %}
							{% for recipe in g.household.recipes %}
							<li class="list-group-item d-flex justify-content-between align-items-center">
								<a href="{{url_for('view_recipe', recipe_id=recipe.id)}}"
									>{{recipe.name}}</a
								>
								<small class="text-muted">by {{ recipe.user.username }}</small>
							</li>
							{% endfor %}
							{% if not g.household.recipes %}
							<li class="list-group-item text-center text-muted">
								<i class="fas fa-utensils mb-2"></i>
								<p>No recipes yet. Add your first recipe!</p>
							</li>
							{% endif %}
						{% else %}
							<li class="list-group-item text-center text-muted">
								<p>Join or create a household to see recipes</p>
							</li>
						{% endif %}
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- Modal -->
<div class="modal-container" id="delete-modal">
	<div class="my-modal">
		<div class="details">
			<h1 class="title">Delete Account</h1>
			<p class="description">Are you sure you want to delete your account?</p>
		</div>
		<div class="modal-actions">
			<form method="POST" action="{{ url_for('delete_account') }}">
				<button type="submit" class="btn btn-danger">Delete Account</button>
			</form>
			<a href="#modal-closed" class="btn btn-outline-secondary">Cancel</a>
		</div>
	</div>
</div>
{% endblock %}

